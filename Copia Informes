function cloneGoogleSheet()
{
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet_alumnes = ss.getSheetByName('Alumnes');
 
  for(i = 1; i <= sheet_alumnes.getLastRow(); i++)
  {
    var separate_name = [{}];
    var complete_name = String(sheet_alumnes.getRange(i, 1).getValue());
    separate_name = complete_name.split(" ");
    var name = separate_name[0];
    var new_name = name;
    if(separate_name.length == 2)
    {
      new_name = new_name + " " + String(separate_name[1]).toUpperCase();
    }
    else if(separate_name.length == 3)
    {
      new_name = new_name + " " +separate_name[1].toUpperCase() + " " +separate_name[2].toUpperCase();
    }
    else if(separate_name.length == 4)
    {
      name = name + " " + separate_name[1];
      new_name = name;
      new_name = new_name + " " +separate_name[2].toUpperCase() + " " +separate_name[3].toUpperCase();
    }
   
    var sheet = ss.getSheetByName('Plantilla').copyTo(ss);
    sheet.setName(name);
    sheet.getRange('A1').setValue(new_name);
  }
}

/*
function deleteRedundantSheets()
{
   var ss = SpreadsheetApp.getActiveSpreadsheet();
   var sheet = ss.getSheets()[0];
   var sheets = SpreadsheetApp.getActiveSpreadsheet().getSheets();

   for (i = 0; i < sheets.length; i++)
   {
     if(sheets[i].getSheetName() != "Plantilla" && sheets[i].getSheetName() != "Alumnes")
     {
       ss.deleteSheet(ss.getSheetByName(sheets[i].getSheetName()));
     }
   }
}
*/
